<!DOCTYPE html>
<html lang="ko-KR">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>ğŸ“‹ MY MEMO</title>
    <script src="https://kit.fontawesome.com/6e1a70c9a1.js" crossorigin="anonymous"></script>
    <link rel="shortcut icon" href="./favicon.ico" type="image/x-icon">
    <!-- <link rel="icon" href="./favicon.ico" type="image/x-icon"> -->

</head>

<body>
    <main>
        <h1>MEMO</h1>
        <button type="button" class="btn-add" onclick="addMemo()">
            <img src="./btnAdd.png" alt="ë©”ëª¨ì…ë ¥í¼ì¶”ê°€">
        </button>
        <div class="container">
        </div>
    </main>
    <script>
        let allMemo = JSON.parse(localStorage.getItem("allMemo"));
        const container = document.querySelector(".container");
        const memoInput = document.getElementById("memo-input");
        let colorMemo = ["color1", "color2", "color3", "color4"];

        allMemo = allMemo ?? [];
        render();

        // plus ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ë©”ëª¨ì§€ ì…ë ¥ ì–‘ì‹ ì¶”ê°€
        function addMemo() {
            const memo = document.createElement("article");
            const form = document.createElement("form");
            container.appendChild(memo);
            memo.appendChild(form);

            const title = document.createElement("input");
            const content = document.createElement("textarea");
            const saveBtn = document.createElement("button");

            memo.classList.add("memo");
            memo.setAttribute("id", "memo-input")
            form.classList.add("form-memo");
            title.type = "text";
            title.id = "title-input";
            title.placeholder = "ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”";

            content.id = "content-input";
            content.cols = "32";
            content.rows = "13";

            saveBtn.type = "text";
            saveBtn.classList.add("btn-save");
            saveBtn.onclick = saveMemo;
            saveBtn.textContent = "ë©”ëª¨ ì €ì¥";

            form.append(title, content, saveBtn);
        }

        // ë©”ëª¨ ë‚´ìš© ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥í•˜ê¸°
        function saveMemo() {
            const title = document.getElementById("title-input").value;
            const content = document.getElementById("content-input").value;
            allMemo.push({ title, content, len: allMemo.length });

            localStorage.setItem("allMemo", JSON.stringify(allMemo));
            render();
        }

        //ì…ë ¥í¼ì—ì„œ ì €ì¥ í›„ ì €ì¥ëœ ë©”ëª¨ ë¶ˆëŸ¬ì˜¤ê¸°
        function render() {
            /**
             * ! ê±´ë“¤ë˜ ë¶€ë¶„ -> allMemoì˜ ê¸¸ì´ì™€ ë™ì¼í•˜ê²Œ ë©”ëª¨ì§€ ìƒì„±ê¹Œì§„ ì™„ë£Œ í•˜ì§€ë§Œ ë‚´ìš©ì€ ì•ˆëœ¸ (í•´ê²°ì™„ë£Œ: ë‚´ìš© ëœ¸)
             * ! ìœ„ë¥¼ í•´ê²°í•˜ë©´ ìƒê¸°ëŠ” ë¬¸ì œ : ìƒˆë¡œìš´ ë©”ëª¨ë¥¼ ì‘ì„±í•˜ë©´ ë¹ˆ ë©”ëª¨ê°€ ë„˜ ë§ì´ìƒê¹€
             * */
            // ë¬¸ì œ: ë©”ëª¨ì§€ê°€ ìˆì–´ì•¼ë§Œ ë Œë”ê°€ ë¨
            // allMemo.lengthë§Œí¼ ë©”ëª¨ì§€ ìƒì„±í•´ì£¼ê¸°
            // if(allMemo.length > 0 && )
            // for (let i = 0; i < allMemo.length; i++) {
            //     const memo = document.createElement("article");
            //     memo.classList.add("memo");
            //     container.append(memo);
            // }
            // container.removeChild(memoInput)
            // ë©”ëª¨ì§€ ìˆ˜ì™€ allMemoì˜ ì¸ë±ìŠ¤ê°€ ê°™ìœ¼ë©´ ì €ì¥ëœ ë©”ëª¨ ì¶œë ¥
            for (let item = 0; item < allMemo.length; item++) {
                const memo = document.createElement("article");
                memo.classList.add("memo");

                const memoInput = document.querySelector(".memo-input");
                const inputTitle = document.getElementById("title-input");
                const inputContent = document.getElementById("content-input");
                const btnSave = document.querySelector(".btn-save");

                // ë©”ëª¨ì§€ ê°œìˆ˜ë‘ ì €ì¥ëœ ë©”ëª¨ ê°œìˆ˜ê°€ ë™ì¼í•˜ë‹¤ë©´ ì¶”ê°€ ë©”ëª¨ì§€ ìƒì„±í•  í•„ìš”ì—†ìŒ

                // for (let i = 0; i <= allMemo.length; i++) {
                //     if (document.querySelector(".container").children.length > 0) {
                //         if (document.querySelector(".container").children[i].className === 'memo-input') {
                //             container.removeChild(memoInput)
                //             container.append(memo);
                //         }
                //     }
                // }

                container.append(memo);
                const memos = document.querySelectorAll(".memo");
                let randomColor = Math.floor(Math.random() * colorMemo.length);

                for (let i = 0; i < memos.length; i++) {
                    if (i === item) {
                        memo.classList.add(colorMemo[randomColor]);
                        const saveTitle = document.createElement("h2");
                        const saveContent = document.createElement("p");
                        const deleteBtn = document.createElement("button");
                        saveTitle.textContent = allMemo[item].title;
                        saveTitle.classList.add("title-memo");

                        saveContent.innerText = allMemo[item].content;
                        saveContent.classList.add("content-memo");

                        deleteBtn.textContent = "Delete";
                        deleteBtn.classList.add("btn-delete");
                        deleteBtn.setAttribute("id", allMemo[item].len);
                        deleteBtn.setAttribute("onclick", "remove()");
                        memo.appendChild(saveTitle);
                        memo.appendChild(saveContent);
                        memo.appendChild(deleteBtn);

                        if (memos.length > allMemo.length) {
                            for (let i = allMemo.length; i < memos.length; i++) {
                                container.removeChild(memos[i])
                            }
                        }
                    }
                }
            }
        }
        // ë©”ëª¨ ì‚­ì œ
        function remove() {
            //srcElement : ì´ë²¤íŠ¸ê°€ ë°œìƒí•œ ê°œì²´ë¥¼ ë°˜í™˜/ì„¤ì •
            const idx = allMemo.find(item => item.len == event.srcElement.id);
            //console.log("idx : ", idx)//ì‚­ì œí•  ëŒ€ìƒ
            if (idx) {
                allMemo.splice(allMemo.findIndex(item => item.len == idx.len), 1);//allMemoì˜ ìš”ì†Œì˜ lenê³¼ ì‚­ì œí•  ì•„ì´í…œì˜ lenì´ ê°™ì€ ì¸ë±ìŠ¤ì—ì„œ 1ê°œ ìš”ì†Œ ì œê±°
            }
            localStorage.setItem("allMemo", JSON.stringify(allMemo));
            render();
            location.reload();
        }

    </script>
</body>

</html>